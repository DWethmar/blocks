{"id":"fb2n","dependencies":[{"name":"/home/dwethmar/Projects/blocks/web/tsconfig.json","includedInParent":true,"mtime":1558787104633},{"name":"/home/dwethmar/Projects/blocks/web/.babelrc","includedInParent":true,"mtime":1558107217825},{"name":"/home/dwethmar/Projects/blocks/web/package.json","includedInParent":true,"mtime":1558785188756},{"name":"../chunk/chunk-repository","loc":{"line":3,"column":33},"parent":"/home/dwethmar/Projects/blocks/web/app/terrain/terrain.ts","resolved":"/home/dwethmar/Projects/blocks/web/app/chunk/chunk-repository.ts"},{"name":"@blocks/core","loc":{"line":5,"column":21},"parent":"/home/dwethmar/Projects/blocks/web/app/terrain/terrain.ts","resolved":"/home/dwethmar/Projects/blocks/web/node_modules/@blocks/core/lib/core.js"},{"name":"../chunk/chunk","loc":{"line":6,"column":22},"parent":"/home/dwethmar/Projects/blocks/web/app/terrain/terrain.ts","resolved":"/home/dwethmar/Projects/blocks/web/app/chunk/chunk.ts"},{"name":"../config","loc":{"line":7,"column":23},"parent":"/home/dwethmar/Projects/blocks/web/app/terrain/terrain.ts","resolved":"/home/dwethmar/Projects/blocks/web/app/config.ts"},{"name":"../block/block-repository","loc":{"line":8,"column":33},"parent":"/home/dwethmar/Projects/blocks/web/app/terrain/terrain.ts","resolved":"/home/dwethmar/Projects/blocks/web/app/block/block-repository.ts"},{"name":"./index-utils","loc":{"line":9,"column":28},"parent":"/home/dwethmar/Projects/blocks/web/app/terrain/terrain.ts","resolved":"/home/dwethmar/Projects/blocks/web/app/terrain/index-utils.ts"}],"generated":{"js":"\"use strict\";exports.__esModule=!0;var e=require(\"../chunk/chunk-repository\"),r=require(\"@blocks/core\"),n=require(\"@blocks/core\"),o=require(\"../chunk/chunk\"),t=require(\"../config\"),c=require(\"../block/block-repository\"),u=require(\"./index-utils\");function i(e,r){console.log(\"Nothing to do fml\",r,e)}function l(i,l){return function(k,s){if(n.isIntegerPoint3D(k)){var a=chunkIndexFromBlockIndex(k),d=e.getChunk(a,i);d||(d=o.createChunk(\"chunk-\"+a.x+\".\"+a.y+\".\"+a.z,r.multiply(t.CHUNK_SIZE*t.BLOCK_SIZE,a)),e.setChunk(d,i),l.add(d),l.activate(d.id)),c.setBlock(u.convertWorldIndexToLocalIndex(k),d.blocks,s)}return!0}}function k(r){return function(o){if(n.isIntegerPoint3D(o)){var t=u.convertWorldIndexToChunkIndex(o),i=e.getChunk(t,r);return i?c.getBlock(u.convertWorldIndexToLocalIndex(o),i.blocks):null}return null}}function s(n,o){var t=e.createChunkRepository();return{id:n,position:r.createPoint(),chunks:t,components:[i.name],setBlock:l(t,o),getBlock:k(t)}}exports.updateTerrain=i,exports.createBlockSetter=l,exports.createBlockGetter=k,exports.createTerrain=s;"},"sourceMaps":{"js":{"mappings":[{"source":"app/terrain/terrain.ts","name":null,"original":{"line":82,"column":0},"generated":{"line":1,"column":0}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":82,"column":0},"generated":{"line":1,"column":13}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":82,"column":0},"generated":{"line":1,"column":21}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":82,"column":0},"generated":{"line":1,"column":33}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":35}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":39}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":41}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":49}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":9,"column":0},"generated":{"line":1,"column":78}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":9,"column":0},"generated":{"line":1,"column":80}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":9,"column":0},"generated":{"line":1,"column":88}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":11,"column":0},"generated":{"line":1,"column":104}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":11,"column":0},"generated":{"line":1,"column":106}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":11,"column":0},"generated":{"line":1,"column":114}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":130}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":132}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":140}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":13,"column":0},"generated":{"line":1,"column":158}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":13,"column":0},"generated":{"line":1,"column":160}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":13,"column":0},"generated":{"line":1,"column":168}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":14,"column":0},"generated":{"line":1,"column":181}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":14,"column":0},"generated":{"line":1,"column":183}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":14,"column":0},"generated":{"line":1,"column":191}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":15,"column":0},"generated":{"line":1,"column":220}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":15,"column":0},"generated":{"line":1,"column":222}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":15,"column":0},"generated":{"line":1,"column":230}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":17,"column":0},"generated":{"line":1,"column":247}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":17,"column":16},"generated":{"line":1,"column":256}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":17,"column":30},"generated":{"line":1,"column":258}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":17,"column":44},"generated":{"line":1,"column":260}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":18,"column":4},"generated":{"line":1,"column":263}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":18,"column":12},"generated":{"line":1,"column":271}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":18,"column":16},"generated":{"line":1,"column":275}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":18,"column":37},"generated":{"line":1,"column":295}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":18,"column":46},"generated":{"line":1,"column":297}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":35,"column":0},"generated":{"line":1,"column":300}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":35,"column":16},"generated":{"line":1,"column":309}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":36,"column":4},"generated":{"line":1,"column":311}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":37,"column":4},"generated":{"line":1,"column":313}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":39,"column":11},"generated":{"line":1,"column":316}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":39,"column":11},"generated":{"line":1,"column":323}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":39,"column":20},"generated":{"line":1,"column":332}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":39,"column":32},"generated":{"line":1,"column":334}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":40,"column":12},"generated":{"line":1,"column":337}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":40,"column":12},"generated":{"line":1,"column":340}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":40,"column":12},"generated":{"line":1,"column":342}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":40,"column":29},"generated":{"line":1,"column":359}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":40,"column":42},"generated":{"line":1,"column":362}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":41,"column":18},"generated":{"line":1,"column":363}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":41,"column":18},"generated":{"line":1,"column":367}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":41,"column":31},"generated":{"line":1,"column":369}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":41,"column":56},"generated":{"line":1,"column":394}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":42,"column":16},"generated":{"line":1,"column":397}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":42,"column":24},"generated":{"line":1,"column":399}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":42,"column":24},"generated":{"line":1,"column":401}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":42,"column":33},"generated":{"line":1,"column":410}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":42,"column":45},"generated":{"line":1,"column":412}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":44,"column":17},"generated":{"line":1,"column":415}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":45,"column":16},"generated":{"line":1,"column":419}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":45,"column":24},"generated":{"line":1,"column":421}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":45,"column":24},"generated":{"line":1,"column":423}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":46,"column":20},"generated":{"line":1,"column":435}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":46,"column":29},"generated":{"line":1,"column":444}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":46,"column":40},"generated":{"line":1,"column":446}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":46,"column":41},"generated":{"line":1,"column":448}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":46,"column":45},"generated":{"line":1,"column":452}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":46,"column":56},"generated":{"line":1,"column":454}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":46,"column":57},"generated":{"line":1,"column":456}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":46,"column":61},"generated":{"line":1,"column":460}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":46,"column":72},"generated":{"line":1,"column":462}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":47,"column":20},"generated":{"line":1,"column":464}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":47,"column":20},"generated":{"line":1,"column":466}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":47,"column":29},"generated":{"line":1,"column":475}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":47,"column":29},"generated":{"line":1,"column":477}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":47,"column":42},"generated":{"line":1,"column":488}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":47,"column":42},"generated":{"line":1,"column":490}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":47,"column":54},"generated":{"line":1,"column":501}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":49,"column":16},"generated":{"line":1,"column":505}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":49,"column":16},"generated":{"line":1,"column":507}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":49,"column":25},"generated":{"line":1,"column":516}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":49,"column":32},"generated":{"line":1,"column":518}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":52,"column":16},"generated":{"line":1,"column":521}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":52,"column":28},"generated":{"line":1,"column":523}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":52,"column":32},"generated":{"line":1,"column":527}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":53,"column":16},"generated":{"line":1,"column":530}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":53,"column":28},"generated":{"line":1,"column":532}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":53,"column":37},"generated":{"line":1,"column":541}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":53,"column":43},"generated":{"line":1,"column":543}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":55,"column":12},"generated":{"line":1,"column":548}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":55,"column":12},"generated":{"line":1,"column":550}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":56,"column":16},"generated":{"line":1,"column":559}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":56,"column":16},"generated":{"line":1,"column":561}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":56,"column":46},"generated":{"line":1,"column":591}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":57,"column":16},"generated":{"line":1,"column":594}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":57,"column":22},"generated":{"line":1,"column":596}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":58,"column":16},"generated":{"line":1,"column":603}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":61,"column":15},"generated":{"line":1,"column":606}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":61,"column":15},"generated":{"line":1,"column":613}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":65,"column":0},"generated":{"line":1,"column":616}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":65,"column":16},"generated":{"line":1,"column":625}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":65,"column":34},"generated":{"line":1,"column":627}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":66,"column":11},"generated":{"line":1,"column":630}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":66,"column":11},"generated":{"line":1,"column":637}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":66,"column":20},"generated":{"line":1,"column":646}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":67,"column":12},"generated":{"line":1,"column":649}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":67,"column":12},"generated":{"line":1,"column":652}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":67,"column":12},"generated":{"line":1,"column":654}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":67,"column":29},"generated":{"line":1,"column":671}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":67,"column":42},"generated":{"line":1,"column":674}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":68,"column":18},"generated":{"line":1,"column":675}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":68,"column":18},"generated":{"line":1,"column":679}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":68,"column":31},"generated":{"line":1,"column":681}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":68,"column":31},"generated":{"line":1,"column":683}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":68,"column":61},"generated":{"line":1,"column":713}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":69,"column":16},"generated":{"line":1,"column":716}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":69,"column":24},"generated":{"line":1,"column":718}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":69,"column":24},"generated":{"line":1,"column":720}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":69,"column":33},"generated":{"line":1,"column":729}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":69,"column":45},"generated":{"line":1,"column":731}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":70,"column":16},"generated":{"line":1,"column":734}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":70,"column":17},"generated":{"line":1,"column":741}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":73,"column":19},"generated":{"line":1,"column":743}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":73,"column":19},"generated":{"line":1,"column":745}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":74,"column":16},"generated":{"line":1,"column":754}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":74,"column":16},"generated":{"line":1,"column":756}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":74,"column":46},"generated":{"line":1,"column":786}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":75,"column":16},"generated":{"line":1,"column":789}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":75,"column":22},"generated":{"line":1,"column":791}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":71,"column":23},"generated":{"line":1,"column":799}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":78,"column":15},"generated":{"line":1,"column":804}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":78,"column":15},"generated":{"line":1,"column":811}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":82,"column":0},"generated":{"line":1,"column":817}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":82,"column":16},"generated":{"line":1,"column":826}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":83,"column":4},"generated":{"line":1,"column":828}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":84,"column":4},"generated":{"line":1,"column":830}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":86,"column":10},"generated":{"line":1,"column":833}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":86,"column":10},"generated":{"line":1,"column":837}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":86,"column":19},"generated":{"line":1,"column":839}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":86,"column":19},"generated":{"line":1,"column":841}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":87,"column":11},"generated":{"line":1,"column":865}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":87,"column":11},"generated":{"line":1,"column":871}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":88,"column":8},"generated":{"line":1,"column":872}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":88,"column":12},"generated":{"line":1,"column":875}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":89,"column":8},"generated":{"line":1,"column":877}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":89,"column":18},"generated":{"line":1,"column":886}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":89,"column":18},"generated":{"line":1,"column":888}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":90,"column":8},"generated":{"line":1,"column":902}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":90,"column":16},"generated":{"line":1,"column":909}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":91,"column":8},"generated":{"line":1,"column":911}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":91,"column":20},"generated":{"line":1,"column":922}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":91,"column":21},"generated":{"line":1,"column":923}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":91,"column":35},"generated":{"line":1,"column":925}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":92,"column":8},"generated":{"line":1,"column":931}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":92,"column":18},"generated":{"line":1,"column":940}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":92,"column":36},"generated":{"line":1,"column":942}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":92,"column":44},"generated":{"line":1,"column":944}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":93,"column":8},"generated":{"line":1,"column":947}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":93,"column":18},"generated":{"line":1,"column":956}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":93,"column":36},"generated":{"line":1,"column":958}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":17,"column":0},"generated":{"line":1,"column":962}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":17,"column":0},"generated":{"line":1,"column":970}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":17,"column":0},"generated":{"line":1,"column":984}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":35,"column":0},"generated":{"line":1,"column":986}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":35,"column":0},"generated":{"line":1,"column":994}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":35,"column":0},"generated":{"line":1,"column":1012}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":65,"column":0},"generated":{"line":1,"column":1014}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":65,"column":0},"generated":{"line":1,"column":1022}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":65,"column":0},"generated":{"line":1,"column":1040}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":82,"column":0},"generated":{"line":1,"column":1042}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":82,"column":0},"generated":{"line":1,"column":1050}},{"source":"app/terrain/terrain.ts","name":null,"original":{"line":82,"column":0},"generated":{"line":1,"column":1064}}],"sources":{"app/terrain/terrain.ts":"import * as PIXI from 'pixi.js';\r\n\r\nimport {\r\n    chunkRepository,\r\n    getChunk,\r\n    setChunk,\r\n    createChunkRepository,\r\n} from '../chunk/chunk-repository';\r\nimport { Scene, Point3D, GameObject, GameObjectRepository, multiply, createPoint } from '@blocks/core';\r\nimport { BlockType } from '../block/block-type';\r\nimport { isIntegerPoint3D } from '@blocks/core';\r\nimport { createChunk } from '../chunk/chunk';\r\nimport { CHUNK_SIZE, BLOCK_SIZE } from '../config';\r\nimport { setBlock, getBlock } from '../block/block-repository';\r\nimport { convertWorldIndexToLocalIndex, convertWorldIndexToChunkIndex } from './index-utils';\r\n\r\nexport function updateTerrain(scene: Scene, terrain: Terrain): void {\r\n    console.log('Nothing to do fml', terrain, scene);\r\n}\r\n\r\nexport type blockSetter = (blockIndex: Point3D, type: BlockType) => boolean;\r\nexport type blockGetter = (blockIndex: Point3D) => BlockType;\r\n\r\nexport interface Terrain extends GameObject {\r\n    chunks: chunkRepository;\r\n    setBlock: blockSetter;\r\n    getBlock: blockGetter;\r\n}\r\n\r\n/**\r\n *\r\n * @param chunks is collection of chunks.\r\n * @param gameObjects is the repository that is used to create new chunks.\r\n */\r\nexport function createBlockSetter(\r\n    chunks: chunkRepository,\r\n    gameObjects: GameObjectRepository,\r\n): blockSetter {\r\n    return function(blockIndex, type): boolean {\r\n        if (isIntegerPoint3D(blockIndex)) {\r\n            const chunkIndex = chunkIndexFromBlockIndex(blockIndex);\r\n            let chunk = getChunk(chunkIndex, chunks);\r\n            // Create chunk if not exist\r\n            if (!chunk) {\r\n                chunk = createChunk(\r\n                    `chunk-${chunkIndex.x}.${chunkIndex.y}.${chunkIndex.z}`,\r\n                    multiply(CHUNK_SIZE * BLOCK_SIZE, chunkIndex),\r\n                );\r\n                setChunk(chunk, chunks);\r\n\r\n                // Register the new chunk\r\n                gameObjects.add(chunk);\r\n                gameObjects.activate(chunk.id);\r\n            }\r\n            setBlock(\r\n                convertWorldIndexToLocalIndex(blockIndex),\r\n                chunk.blocks,\r\n                type,\r\n            );\r\n        }\r\n        return true;\r\n    };\r\n}\r\n\r\nexport function createBlockGetter(chunks: chunkRepository): blockGetter {\r\n    return function(blockIndex): BlockType {\r\n        if (isIntegerPoint3D(blockIndex)) {\r\n            const chunkIndex = convertWorldIndexToChunkIndex(blockIndex);\r\n            let chunk = getChunk(chunkIndex, chunks);\r\n            if (!chunk) {\r\n                return null;\r\n            }\r\n            return getBlock(\r\n                convertWorldIndexToLocalIndex(blockIndex),\r\n                chunk.blocks,\r\n            );\r\n        }\r\n        return null;\r\n    };\r\n}\r\n\r\nexport function createTerrain(\r\n    id: string,\r\n    gameObjects: GameObjectRepository,\r\n): Terrain {\r\n    const chunks = createChunkRepository();\r\n    return {\r\n        id: id,\r\n        position: createPoint(),\r\n        chunks: chunks,\r\n        components: [updateTerrain.name],\r\n        setBlock: createBlockSetter(chunks, gameObjects),\r\n        getBlock: createBlockGetter(chunks),\r\n    };\r\n}\r\n"},"lineCount":null}},"error":null,"hash":"2c56b4f3bdd7c703d0d10fa7a3628c36","cacheData":{"env":{}}}